<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BTC Mini Trader</title>

  <style>
    :root { --bg:#0b1220; --card:#111a2c; --text:#e6eefc; --muted:#9bb0d0; }
    *{ box-sizing:border-box; }
    body{
      margin:0; padding:16px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg); color: var(--text);
    }
    .wrap{ max-width:520px; margin:0 auto; }
    .card{
      background: var(--card);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .title{ font-size:18px; margin:0 0 10px 0; }
    .price{
      font-size:34px; font-weight:800; letter-spacing: .2px;
      margin: 0 0 4px 0;
    }
    .sub{ color: var(--muted); margin:0 0 16px 0; font-size:13px; }
    .row{ display:flex; gap:12px; }
    button{
      width:100%;
      padding:14px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      color: var(--text);
      background: rgba(255,255,255,.06);
      font-size:16px;
      font-weight:700;
      cursor:pointer;
      user-select:none;
    }
    .hidden{ display:none !important; }
    .pnlBox{
      margin-top:14px;
      padding:12px;
      border-radius: 12px;
      border: 1px dashed rgba(255,255,255,.14);
      background: rgba(255,255,255,.03);
    }
    .pnlLabel{ color: var(--muted); font-size:13px; margin:0 0 6px 0; }
    .pnlValue{ font-size:22px; font-weight:800; margin:0; }
    .small{ color: var(--muted); font-size:12px; margin-top:10px; }
    .tag{
      display:inline-block;
      padding:4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      font-size:12px; color: var(--muted);
      margin-left:8px;
      vertical-align: middle;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1 class="title">–ú–∏–Ω–∏-—Ç—Ä–µ–π–¥–µ—Ä BTC/USD <span id="posTag" class="tag hidden"></span></h1>

      <p class="price" id="price">$45,000.00</p>
      <p class="sub">–ö—É—Ä—Å –º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –Ω–∞ ¬±1% (—Å–ª—É—á–∞–π–Ω–æ).</p>

      <div class="row" id="entryRow">
        <button id="longBtn">–õ–æ–Ω–≥</button>
        <button id="shortBtn">–®–æ—Ä—Ç</button>
      </div>

      <div class="row hidden" id="closeRow">
        <button id="closeBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>

      <div class="pnlBox hidden" id="pnlBox">
        <p class="pnlLabel">–¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (PnL)</p>
        <p class="pnlValue" id="pnlValue">0.00%</p>
        <div class="small" id="pnlDetails"></div>
      </div>
    </div>
  </div>

  <script>
    // --- State
    let price = 45000;
    let position = null; // 'long' | 'short' | null
    let entryPrice = null;
    let lastPnl = 0;

    // --- DOM
    const priceEl = document.getElementById('price');
    const longBtn = document.getElementById('longBtn');
    const shortBtn = document.getElementById('shortBtn');
    const closeBtn = document.getElementById('closeBtn');
    const entryRow = document.getElementById('entryRow');
    const closeRow = document.getElementById('closeRow');
    const pnlBox = document.getElementById('pnlBox');
    const pnlValue = document.getElementById('pnlValue');
    const pnlDetails = document.getElementById('pnlDetails');
    const posTag = document.getElementById('posTag');

    // --- Helpers
    function fmtMoney(x) {
      return x.toLocaleString('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 2 });
    }
    function fmtPct(x) {
      const sign = x > 0 ? '+' : '';
      return `${sign}${x.toFixed(2)}%`;
    }
    function randomStepWithin1pct() {
      return (Math.random() * 2 - 1) * 0.01; // -1%..+1%
    }

    function calcPnlPercent() {
      if (!position || !entryPrice) return 0;
      if (position === 'long') return (price / entryPrice - 1) * 100;
      return (entryPrice / price - 1) * 100; // short
    }

    function renderPrice() {
      priceEl.textContent = fmtMoney(price);
    }

    function renderPnl() {
      lastPnl = calcPnlPercent();
      pnlValue.textContent = (lastPnl >= 0 ? 'üü¢ ' : 'üî¥ ') + fmtPct(lastPnl);
      pnlDetails.textContent = `–í—Ö–æ–¥: ${fmtMoney(entryPrice)} ‚Ä¢ –°–µ–π—á–∞—Å: ${fmtMoney(price)}`;
    }

    function resetUI() {
      position = null;
      entryPrice = null;
      lastPnl = 0;

      entryRow.classList.remove('hidden');
      closeRow.classList.add('hidden');
      pnlBox.classList.add('hidden');

      posTag.classList.add('hidden');
      posTag.textContent = '';
    }

    // --- Trading
    function openPosition(type) {
      if (position) return;
      position = type;
      entryPrice = price;

      entryRow.classList.add('hidden');
      closeRow.classList.remove('hidden');

      pnlBox.classList.remove('hidden');
      posTag.textContent = type.toUpperCase();
      posTag.classList.remove('hidden');

      renderPnl();
    }

    function closePosition() {
      if (!position) return;

      renderPnl();
      const text =
        `${position.toUpperCase()} ‚Ä¢ –í—Ö–æ–¥: ${fmtMoney(entryPrice)} ‚Üí –í—ã—Ö–æ–¥: ${fmtMoney(price)}\n` +
        `–ò—Ç–æ–≥: ${fmtPct(lastPnl)}`;

      alert(text);      // ‚Üê –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
      resetUI();
    }

    // --- Events
    longBtn.addEventListener('click', () => openPosition('long'));
    shortBtn.addEventListener('click', () => openPosition('short'));
    closeBtn.addEventListener('click', closePosition);

    // --- Price loop
    setInterval(() => {
      const step = randomStepWithin1pct();
      price = Math.max(price * (1 + step), 1);
      renderPrice();
      if (position) renderPnl();
    }, 1000);

    renderPrice();
  </script>
</body>
</html>
